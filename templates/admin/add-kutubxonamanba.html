{% extends "admin/base.html" %}
{% block title %}Bosh sahifa{% endblock %}
{% block content %}
{% load static %}
{% load crispy_forms_tags %}

<div class="pagetitle">
    <h1>Form Layouts</h1>
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
            <li class="breadcrumb-item">Forms</li>
            <li class="breadcrumb-item active">Layouts</li>
        </ol>
    </nav>
</div><!-- End Page Title -->
<section class="section">
    <div class="row">

        <div class="col-lg-3">

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        {% if mankutubxona %}
                        Manbani Tahrirlash
                        {% else %}
                        Manba Qo'shish
                        {% endif %}
                    </h5>

                    <!-- Vertical Form -->
                    <form action="" method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        {{ form|crispy }}
                        <button class="btn btn-success" type="submit">
                            {% if mankutubxona %}
                            Manbani tahrirlash
                            {% else %}
                            Manba qo'shish
                            {% endif %}
                        </button>
                    </form>

                    <script>
document.addEventListener("DOMContentLoaded", function () {
    const typeSelect = document.getElementById("id_resource_type");
    const fileInput = document.getElementById("div_id_file");
    const linkInput = document.getElementById("div_id_external_link");

    function toggleFields() {
        if (typeSelect.value === "file") {
            fileInput.style.display = "block";
            linkInput.style.display = "none";
        } else if (typeSelect.value === "link") {
            fileInput.style.display = "none";
            linkInput.style.display = "block";
        }
    }

    toggleFields(); // sahifa ochilganda
    typeSelect.addEventListener("change", toggleFields);
});
</script>

                </div>
            </div>
        </div>
        <div class="col-lg-9">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Manba Fayllar ro'yxati</h5>
                    <!-- Active Table -->
                    <table class="table table-borderless">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>Bo'lim</th>
                            <th>Nomi</th>
                            <th>Fayl</th>
                            <th>Vaqti</th>
                            <th scope="col">Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for i in manbalar %}
                        <tr>
                            <th scope="row">{{ i.id }}</th>
                            <td>{{ i.category }}</td>
                            <td>{{ i.title }}</td>
                            <td>
                                {% if i.file %}
                                <a href="{{ i.file.url }}" target="_blank">Faylni ko'rish</a>
                                {% else %}
                                <a href="{{ i.external_link }}" target="_blank">Fayl Link</a>
                                {% endif %}
                            </td>
                            <td>{{ i.created_at|date:"d M Y" }}</td>
                            <td>
                                <a href="{% url 'inclusive_app:admin_add_mankutubxona' i.id %}"
                                   class="btn btn-sm btn-outline-success"><i class="bi bi-pen"></i></a>
                                <a href="{% url 'inclusive_app:admin_delete_mankutubxona' i.id %}"
                                   class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></a>
                            </td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <!-- End Tables without borders -->

                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}